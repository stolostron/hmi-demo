---
# tasks file for kiosk_mode
- name: Register as user with password and auto-subscribe to available content.
  community.general.redhat_subscription:
    state: present
    username: "{{ rhsm_username }}"
    password: "{{ rhsm_password }}"
    auto_attach: true

- name: install Gnome Desktop Environment
  ansible.builtin.yum:
    name: "@Server With GUI"
    state: latest

- name: create systemd service for firefox
  ansible.builtin.template:
    src: firefox.service
    dest: /etc/systemd/system/firefox.service
    mode: 0644

- name: Create gdm configuration for kiosk kiosk_mode
  ansible.builtin.template:
    src: custom.conf
    dest: /etc/gdm/custom.conf
    mode: 0644

- name: Add the user 'kiosk' 
  ansible.builtin.user:
    name: kiosk
    comment: kiosk user

- name: configure session for kiosk username /var/lib/AccountsService/users/kiosk
  ansible.builtin.template:
    src: kiosk.conf
    dest: /var/lib/AccountsService/users/kiosk
    mode: 0644
  